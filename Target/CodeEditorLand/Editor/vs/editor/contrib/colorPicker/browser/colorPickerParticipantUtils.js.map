{
  "version": 3,
  "sources": ["../../../../../../../../Dependency/Land/Dependency/Editor/Source/vs/editor/contrib/colorPicker/browser/colorPickerParticipantUtils.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Color, RGBA } from '../../../../base/common/color.js';\nimport { IActiveCodeEditor } from '../../../browser/editorBrowser.js';\nimport { ISingleEditOperation } from '../../../common/core/editOperation.js';\nimport { DocumentColorProvider, IColorInformation } from '../../../common/languages.js';\nimport { ITextModel, TrackedRangeStickiness } from '../../../common/model.js';\nimport { getColorPresentations } from './color.js';\nimport { ColorPickerModel } from './colorPickerModel.js';\nimport { Range } from '../../../common/core/range.js';\n\nexport interface BaseColor {\n\treadonly range: Range;\n\treadonly model: ColorPickerModel;\n\treadonly provider: DocumentColorProvider;\n}\n\nexport async function createColorHover(editorModel: ITextModel, colorInfo: IColorInformation, provider: DocumentColorProvider): Promise<BaseColor> {\n\tconst originalText = editorModel.getValueInRange(colorInfo.range);\n\tconst { red, green, blue, alpha } = colorInfo.color;\n\tconst rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\n\tconst color = new Color(rgba);\n\n\tconst colorPresentations = await getColorPresentations(editorModel, colorInfo, provider, CancellationToken.None);\n\tconst model = new ColorPickerModel(color, [], 0);\n\tmodel.colorPresentations = colorPresentations || [];\n\tmodel.guessColorPresentation(color, originalText);\n\n\treturn {\n\t\trange: Range.lift(colorInfo.range),\n\t\tmodel,\n\t\tprovider\n\t};\n}\n\nexport function updateEditorModel(editor: IActiveCodeEditor, range: Range, model: ColorPickerModel): Range {\n\tconst textEdits: ISingleEditOperation[] = [];\n\tconst edit = model.presentation.textEdit ?? { range, text: model.presentation.label, forceMoveMarkers: false };\n\ttextEdits.push(edit);\n\n\tif (model.presentation.additionalTextEdits) {\n\t\ttextEdits.push(...model.presentation.additionalTextEdits);\n\t}\n\tconst replaceRange = Range.lift(edit.range);\n\tconst trackedRange = editor.getModel()._setTrackedRange(null, replaceRange, TrackedRangeStickiness.GrowsOnlyWhenTypingAfter);\n\teditor.executeEdits('colorpicker', textEdits);\n\teditor.pushUndoStop();\n\treturn editor.getModel()._getTrackedRange(trackedRange) ?? replaceRange;\n}\n\nexport async function updateColorPresentations(editorModel: ITextModel, colorPickerModel: ColorPickerModel, color: Color, range: Range, colorHover: BaseColor): Promise<void> {\n\tconst colorPresentations = await getColorPresentations(editorModel, {\n\t\trange: range,\n\t\tcolor: {\n\t\t\tred: color.rgba.r / 255,\n\t\t\tgreen: color.rgba.g / 255,\n\t\t\tblue: color.rgba.b / 255,\n\t\t\talpha: color.rgba.a\n\t\t}\n\t}, colorHover.provider, CancellationToken.None);\n\tcolorPickerModel.colorPresentations = colorPresentations || [];\n}\n"],
  "mappings": ";;AAKA,SAAS,yBAAyB;AAClC,SAAS,OAAO,YAAY;AAC5B,SAAS,yBAAyB;AAClC,SAAS,4BAA4B;AACrC,SAAS,uBAAuB,yBAAyB;AACzD,SAAS,YAAY,8BAA8B;AACnD,SAAS,6BAA6B;AACtC,SAAS,wBAAwB;AACjC,SAAS,aAAa;AAQtB,eAAsB,iBAAiB,aAAyB,WAA8B,UAAqD;AAClJ,QAAM,eAAe,YAAY,gBAAgB,UAAU,KAAK;AAChE,QAAM,EAAE,KAAK,OAAO,MAAM,MAAM,IAAI,UAAU;AAC9C,QAAM,OAAO,IAAI,KAAK,KAAK,MAAM,MAAM,GAAG,GAAG,KAAK,MAAM,QAAQ,GAAG,GAAG,KAAK,MAAM,OAAO,GAAG,GAAG,KAAK;AACnG,QAAM,QAAQ,IAAI,MAAM,IAAI;AAE5B,QAAM,qBAAqB,MAAM,sBAAsB,aAAa,WAAW,UAAU,kBAAkB,IAAI;AAC/G,QAAM,QAAQ,IAAI,iBAAiB,OAAO,CAAC,GAAG,CAAC;AAC/C,QAAM,qBAAqB,sBAAsB,CAAC;AAClD,QAAM,uBAAuB,OAAO,YAAY;AAEhD,SAAO;AAAA,IACN,OAAO,MAAM,KAAK,UAAU,KAAK;AAAA,IACjC;AAAA,IACA;AAAA,EACD;AACD;AAhBsB;AAkBf,SAAS,kBAAkB,QAA2B,OAAc,OAAgC;AAC1G,QAAM,YAAoC,CAAC;AAC3C,QAAM,OAAO,MAAM,aAAa,YAAY,EAAE,OAAO,MAAM,MAAM,aAAa,OAAO,kBAAkB,MAAM;AAC7G,YAAU,KAAK,IAAI;AAEnB,MAAI,MAAM,aAAa,qBAAqB;AAC3C,cAAU,KAAK,GAAG,MAAM,aAAa,mBAAmB;AAAA,EACzD;AACA,QAAM,eAAe,MAAM,KAAK,KAAK,KAAK;AAC1C,QAAM,eAAe,OAAO,SAAS,EAAE,iBAAiB,MAAM,cAAc,uBAAuB,wBAAwB;AAC3H,SAAO,aAAa,eAAe,SAAS;AAC5C,SAAO,aAAa;AACpB,SAAO,OAAO,SAAS,EAAE,iBAAiB,YAAY,KAAK;AAC5D;AAbgB;AAehB,eAAsB,yBAAyB,aAAyB,kBAAoC,OAAc,OAAc,YAAsC;AAC7K,QAAM,qBAAqB,MAAM,sBAAsB,aAAa;AAAA,IACnE;AAAA,IACA,OAAO;AAAA,MACN,KAAK,MAAM,KAAK,IAAI;AAAA,MACpB,OAAO,MAAM,KAAK,IAAI;AAAA,MACtB,MAAM,MAAM,KAAK,IAAI;AAAA,MACrB,OAAO,MAAM,KAAK;AAAA,IACnB;AAAA,EACD,GAAG,WAAW,UAAU,kBAAkB,IAAI;AAC9C,mBAAiB,qBAAqB,sBAAsB,CAAC;AAC9D;AAXsB;",
  "names": []
}
