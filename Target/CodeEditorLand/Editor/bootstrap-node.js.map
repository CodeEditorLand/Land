{
  "version": 3,
  "sources": ["../../../Dependency/Land/Dependency/Editor/Source/bootstrap-node.ts"],
  "sourcesContent": ["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as fs from 'fs';\nimport { fileURLToPath } from 'url';\nimport { createRequire } from 'node:module';\nimport type { IProductConfiguration } from './vs/base/common/product';\n\nconst require = createRequire(import.meta.url);\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\n\n// increase number of stack frames(from 10, https://github.com/v8/v8/wiki/Stack-Trace-API)\nError.stackTraceLimit = 100;\n\nif (!process.env['VSCODE_HANDLES_SIGPIPE']) {\n\t// Workaround for Electron not installing a handler to ignore SIGPIPE\n\t// (https://github.com/electron/electron/issues/13254)\n\tlet didLogAboutSIGPIPE = false;\n\tprocess.on('SIGPIPE', () => {\n\t\t// See https://github.com/microsoft/vscode-remote-release/issues/6543\n\t\t// In certain situations, the console itself can be in a broken pipe state\n\t\t// so logging SIGPIPE to the console will cause an infinite async loop\n\t\tif (!didLogAboutSIGPIPE) {\n\t\t\tdidLogAboutSIGPIPE = true;\n\t\t\tconsole.error(new Error(`Unexpected SIGPIPE`));\n\t\t}\n\t});\n}\n\n// Setup current working directory in all our node & electron processes\n// - Windows: call `process.chdir()` to always set application folder as cwd\n// -  all OS: store the `process.cwd()` inside `VSCODE_CWD` for consistent lookups\nfunction setupCurrentWorkingDirectory(): void {\n\ttry {\n\n\t\t// Store the `process.cwd()` inside `VSCODE_CWD`\n\t\t// for consistent lookups, but make sure to only\n\t\t// do this once unless defined already from e.g.\n\t\t// a parent process.\n\t\tif (typeof process.env['VSCODE_CWD'] !== 'string') {\n\t\t\tprocess.env['VSCODE_CWD'] = process.cwd();\n\t\t}\n\n\t\t// Windows: always set application folder as current working dir\n\t\tif (process.platform === 'win32') {\n\t\t\tprocess.chdir(path.dirname(process.execPath));\n\t\t}\n\t} catch (err) {\n\t\tconsole.error(err);\n\t}\n}\n\nsetupCurrentWorkingDirectory();\n\n/**\n * Add support for redirecting the loading of node modules\n *\n * Note: only applies when running out of sources.\n */\nexport function devInjectNodeModuleLookupPath(injectPath: string): void {\n\tif (!process.env['VSCODE_DEV']) {\n\t\treturn; // only applies running out of sources\n\t}\n\n\tif (!injectPath) {\n\t\tthrow new Error('Missing injectPath');\n\t}\n\n\t// register a loader hook\n\tconst Module = require('node:module');\n\tModule.register('./bootstrap-import.js', { parentURL: import.meta.url, data: injectPath });\n}\n\nexport function removeGlobalNodeJsModuleLookupPaths(): void {\n\tif (typeof process?.versions?.electron === 'string') {\n\t\treturn; // Electron disables global search paths in https://github.com/electron/electron/blob/3186c2f0efa92d275dc3d57b5a14a60ed3846b0e/shell/common/node_bindings.cc#L653\n\t}\n\n\tconst Module = require('module');\n\tconst globalPaths = Module.globalPaths;\n\n\tconst originalResolveLookupPaths = Module._resolveLookupPaths;\n\n\tModule._resolveLookupPaths = function (moduleName: string, parent: any): string[] {\n\t\tconst paths = originalResolveLookupPaths(moduleName, parent);\n\t\tif (Array.isArray(paths)) {\n\t\t\tlet commonSuffixLength = 0;\n\t\t\twhile (commonSuffixLength < paths.length && paths[paths.length - 1 - commonSuffixLength] === globalPaths[globalPaths.length - 1 - commonSuffixLength]) {\n\t\t\t\tcommonSuffixLength++;\n\t\t\t}\n\n\t\t\treturn paths.slice(0, paths.length - commonSuffixLength);\n\t\t}\n\n\t\treturn paths;\n\t};\n}\n\n/**\n * Helper to enable portable mode.\n */\nexport function configurePortable(product: Partial<IProductConfiguration>): { portableDataPath: string; isPortable: boolean } {\n\tconst appRoot = path.dirname(__dirname);\n\n\tfunction getApplicationPath(): string {\n\t\tif (process.env['VSCODE_DEV']) {\n\t\t\treturn appRoot;\n\t\t}\n\n\t\tif (process.platform === 'darwin') {\n\t\t\treturn path.dirname(path.dirname(path.dirname(appRoot)));\n\t\t}\n\n\t\treturn path.dirname(path.dirname(appRoot));\n\t}\n\n\tfunction getPortableDataPath(): string {\n\t\tif (process.env['VSCODE_PORTABLE']) {\n\t\t\treturn process.env['VSCODE_PORTABLE'];\n\t\t}\n\n\t\tif (process.platform === 'win32' || process.platform === 'linux') {\n\t\t\treturn path.join(getApplicationPath(), 'data');\n\t\t}\n\n\t\tconst portableDataName = product.portable || `${product.applicationName}-portable-data`;\n\t\treturn path.join(path.dirname(getApplicationPath()), portableDataName);\n\t}\n\n\tconst portableDataPath = getPortableDataPath();\n\tconst isPortable = !('target' in product) && fs.existsSync(portableDataPath);\n\tconst portableTempPath = path.join(portableDataPath, 'tmp');\n\tconst isTempPortable = isPortable && fs.existsSync(portableTempPath);\n\n\tif (isPortable) {\n\t\tprocess.env['VSCODE_PORTABLE'] = portableDataPath;\n\t} else {\n\t\tdelete process.env['VSCODE_PORTABLE'];\n\t}\n\n\tif (isTempPortable) {\n\t\tif (process.platform === 'win32') {\n\t\t\tprocess.env['TMP'] = portableTempPath;\n\t\t\tprocess.env['TEMP'] = portableTempPath;\n\t\t} else {\n\t\t\tprocess.env['TMPDIR'] = portableTempPath;\n\t\t}\n\t}\n\n\treturn {\n\t\tportableDataPath,\n\t\tisPortable\n\t};\n}\n"],
  "mappings": "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",
  "names": ["require"]
}
